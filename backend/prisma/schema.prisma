// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String
  password  String
  tasks     Task[]
  projetos  Projeto[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

model Task {
  id          String   @id @default(cuid())
  title       String
  description String?
  completed   Boolean  @default(false)
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("tasks")
}

model Projeto {
  id                     Int      @id @default(autoincrement())
  nome                   String
  nome_empresa           String
  cnpj                   String
  cnae                   String
  endereco               String
  cep                    String
  bairro                 String
  cidade                 String
  estado                 String
  telefone_contato       String
  responsavel            String
  tipo_projeto           String
  numero_projeto_anterior String?
  data_criacao           DateTime @default(now())
  situacao               Int      @default(1)
  user                   User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId                 String
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt
  perfisLocal            PerfilLocal[]

  @@map("projetos")
}

model PerfilLocal {
  id                        Int       @id @default(autoincrement())
  projeto                   Projeto   @relation(fields: [projetoId], references: [id], onDelete: Cascade)
  projetoId                 Int
  tipo_projeto              String?                                         // Item 5
  ocupacao_edificacao       String?                                         // Item 6 (ligado à Tabela 1 do Decreto)
  codigo_divisao            String?                                         // Código da divisão da Tabela1
  altura_edificacao         Float?                                          // Item 7
  area_edificacao           Float?                                          // Item 7B
  grupo_incendio            String?                                         // Item 8 (baixo, médio, alto)
  plano_prevencao           Boolean?                                        // Item 9
  projeto_tecnico           String?                                         // Item 10 (referência de tabela técnica)
  qtde_saidas_emergencia    Int?                                            // Item 11
  sinalizacao_emergencia    String?                                         // Item 12 (quantidade e tipos)
  extintores                String?                                         // Item 13 (tipo e peso)
  qtde_iluminacao_emergencia Int?                                           // Item 14
  qtde_pavimentos           Int?                                            // Item 15
  area_subsolo              Float?                                          // Item 16
  ocupacao_subsolo          String?                                         // Item 17
  area_central_gas          Float?                                          // Item 18
  tipo_cilindro_gas         String?                                         // Item 18
  qtde_hidrantes            Int?                                            // Item 19
  qtde_mangotinhos          Int?                                            // Item 19
  bombas_incendio           String?                                         // Item 20 (quantidade e capacidade)
  lci_reservatorio          Float?                                          // Item 21 (m³/L)
  createdAt                 DateTime  @default(now())
  updatedAt                 DateTime  @updatedAt

  @@map("perfis_local")
}

model Tabela1 {
  id                    Int      @id @default(autoincrement())
  codigo                String   @unique
  ocupacao              String
  classificacao         String?
  grupo                 String?
  subgrupo              String?
  divisao               String?
  carga_incendio_mj_m2  Decimal? @map("carga_incendio_mj_m2")
  observacoes           String?
  ativo                 Boolean  @default(true)
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt

  @@map("tabela1")
}

model Tabela2 {
  id           Int      @id @default(autoincrement())
  tipo         String   @unique
  denominacao  String
  altura       String
  ativo        Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  @@map("tabela2")
}

model AnexoA {
  id                    Int      @id @default(autoincrement())
  ocupacao_uso          String
  descricao             String
  divisao               String
  cnae                  String
  carga_incendio_mj_m2  Int
  ativo                 Boolean  @default(true)
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt

  @@map("anexoa")
}
